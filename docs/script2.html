<body>
<pre id="script"></pre>
<script>
	const PHI     = 1.61803398875;
    const bf      = 90;
    const b       = bf * Math.pow(PHI, -7);
    const f       = (n, i) => bf * Math.pow(2, i/n);
	
    let audio     = null;
    let o_1_left  = null;
    let o_1_right = null;
    let o_2_left  = null;
    let o_2_right = null;
    let o_3_left  = null;
    let o_3_right = null;
	let g         = null;
	let id        = null;

	const s1 = [ // v = .6
		bf * f(16,  0), 
		bf * f(16,  4), 
		bf * f(16,  8), 
		bf * f(16,  8), 
		bf * f(16, -2), 
		bf * f(16,  2), 
		bf * f(16,  6), 
		bf * f(16,  6)
	];

	const s2 = [ // v = 1, d = 8
		0,
		bf * f(16, 25), 
		bf * f(16, 20), 
		bf * f(16, 17), 
		bf * f(16, 14), 
	];

	const s3 = [  // v = .8, d = 40
		bf * f(20, 25), 
		bf * f(20, 29)
	];
	
	let i1 = 0;
	let i2 = 0;
	let i3 = 0;

    const loop = _ => {
       	o_1_left .frequency.setTargetAtTime(s1[i1]    , audio.currentTime, .05);
		o_1_right.frequency.setTargetAtTime(s1[i1] + b, audio.currentTime, .05); 
		if (i1 % 8 === 0) {
	       	o_2_left .frequency.setTargetAtTime(s2[i2]    , audio.currentTime, .05);
			o_2_right.frequency.setTargetAtTime(s2[i2] + b, audio.currentTime, .05); 
			i2 = (i2 + 1) % s2.length;
		}
		if (i1 % 40 === 0) {
	       	o_3_left .frequency.setTargetAtTime(s3[i3]    , audio.currentTime, .05);
			o_3_right.frequency.setTargetAtTime(s3[i3] + b, audio.currentTime, .05); 
			i3 = (i3 + 1) % s3.length;
		}
		i1 = (i1 + 1) % 40;
    };
    
    document.body.addEventListener("click", _ => {
		if (audio === null) {
	        audio = new (window.AudioContext || window.webkitAudioContext)();
		}
		if (id === null) {
			i1 = 0;
			i2 = 0;
			i3 = 0;
	        const g = audio.createGain();
	        g.gain.value = 0;
	        g.connect(audio.destination);
	        g.gain.setTargetAtTime(.5, audio.currentTime, .05);
	    	const merger = audio.createChannelMerger();
	    	merger.connect(g);
	    	o_1_left  = audio.createOscillator();
	    	o_1_right = audio.createOscillator();
	    	o_2_left  = audio.createOscillator();
	    	o_2_right = audio.createOscillator();
	    	o_3_left  = audio.createOscillator();
	    	o_3_right = audio.createOscillator();
	        o_1_left .connect(merger, 0, 0);
	        o_1_right.connect(merger, 0, 1);
	        o_2_left .connect(merger, 0, 0);
	        o_2_right.connect(merger, 0, 1);
	        o_3_left .connect(merger, 0, 0);
	        o_3_right.connect(merger, 0, 1);
	        o_1_left .frequency.value = bf;
	        o_1_right.frequency.value = bf;
	        o_2_left .frequency.value = bf;
	        o_2_right.frequency.value = bf;
	        o_3_left .frequency.value = bf;
	        o_3_right.frequency.value = bf;
	        o_1_left .connect(g);
	        o_1_right.connect(g);
	        o_2_left .connect(g);
	        o_2_right.connect(g);
	        o_3_left .connect(g);
	        o_3_right.connect(g);
	        o_1_left .start();
	        o_1_right.start();
	        o_2_left .start();
	        o_2_right.start();
	        o_3_left .start();
	        o_3_right.start();
	        id = setInterval(loop, 1000);
		} else {
			g.gain.setTargetAtTime(.5, audio.currentTime, .05);
			
			clearInterval(id);
			id = null;
		}

    });
    document.getElementById("script").append(document.body.innerHTML);
</script>
</body>